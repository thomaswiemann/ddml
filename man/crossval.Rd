% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/crossval.R
\name{crossval}
\alias{crossval}
\title{Compute out-of-sample residuals via cross-validation.}
\usage{
crossval(
  y,
  X,
  Z = NULL,
  learners,
  cv_folds = 5,
  cv_subsamples = NULL,
  silent = F
)
}
\arguments{
\item{y}{A response vector.}

\item{X}{A feature matrix.}

\item{Z}{An optional instrument matrix.}

\item{learners}{A list of lists, each containing three named elements:
\itemize{
    \item{\code{fun} The function used to trained the model. The
        function must be such that it predicts a named input \code{y}
        using a named input \code{X}.}
    \item{\code{assign_X} A vector of indices corresponding to features
        in \code{X} that should be used for training.}
    \item{\code{assign_Z} An optional vector of indices corresponding to
        instruments in \code{Z} that should be used for training.}
    \item{\code{args} Optional arguments to be passed to \code{what}}
}}

\item{cv_folds}{The number for cross-validation folds.}

\item{cv_subsamples}{An optional list of vectors, each containing indices of
a test-sample. If not used-provided, the split sample folds are randomly
drawn.}

\item{silent}{A boolean indicating whether current learners and folds should be
printed to the console.}

\item{setup_parallel}{An list containing two named elements:
\itemize{
    \item{\code{type} A string of value \code{"static"} or
        \code{"dynamic"}, indicating whether job scheduling should be
        static (via \code{parSapply}) or dynamic (via \code{foreach}).}
    \item{\code{cores} The number of processor units utilized. Note that
        if \code{cores == 1}, \code{crossval} will not be computed in
        parallel.
    }
}}
}
\value{
\code{crossval} a list containig the following components:
\describe{
\item{\code{oos_resid}}{A matrix of out-of-sample residuals, each column
    corresponding to a model in \code{learners}.}
\item{\code{cv_Z}}{A vector of model indices corresponding to learners that
    selected at least one instrument in each cross-validation fold.}
}
}
\description{
Compute out-of-sample residuals via cross-validation.
}
\examples{

# Simple example w/o instruments ============================================
# Simulate small dataset
X <- cbind(1, matrix(rnorm(100*99), 100, 99)) # Simulate features
y <- X \%*\% (10*runif(100) * (runif(100) < 0.05)) + rnorm(100)
# Define arguments
learners <- list(list(fun = rlasso,
                    args = list(include = NULL,
                                iter_resid = 1, d = 5),
                    assign_X = c(1:ncol(X))), # rlasso
               list(fun = ols,
                    args = list(),
                    assign_X = c(1:ncol(X))), # ols w/ all features
               list(fun = ols,
                    args = list(),
                    assign_X = c(1:50)) # ols w/ some arbitrary features
# Compute cross-validation residuals
cv_res <- crossval(y, X,
                   learners = learners,
                   cv_folds = 3,
                   silent = T)
# Compute MSPE by model
colMeans(cv_res$oos_resid)

}
