<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Estimate common causal parameters using double/debiased machine 
    learning. ddml simplifies estimation based on stacking, which 
    simultaneously leverages multiple base learners to increase robustness to
    the underlying data generating process.">
<title>Double/Debiased Machine Learning in R • ddml</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Double/Debiased Machine Learning in R">
<meta property="og:description" content="Estimate common causal parameters using double/debiased machine 
    learning. ddml simplifies estimation based on stacking, which 
    simultaneously leverages multiple base learners to increase robustness to
    the underlying data generating process.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ddml</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/ddml.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/example_401k.html">Example on the Effect of 401k Participation</a>
    <a class="dropdown-item" href="articles/example_BLP1995.html">Example using Berry, Levinson, Pakes (1995)</a>
    <a class="dropdown-item" href="articles/example_keras_wrapper.html">Constructing a new ML Wrapper</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thomaswiemann/ddml/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ddml">ddml<a class="anchor" aria-label="anchor" href="#ddml"></a>
</h1></div>
<!-- badges: start -->

<p><code>ddml</code> is an implementation of double/debiased machine learning estimators targeting common causal parameters such as the average treatment effect. The key benefit of the package is the straightforward estimation of nuisance parameters using stacking, which simultaneously leverages multiple base learners to increase robustness to the underlying data generating process.</p>
<p><code>ddml</code> is the sister R package to our <a href="https://github.com/aahrens1/ddml/" class="external-link">Stata</a> package, mirroring its key features while also leveraging R to simplify estimation with user-provided learners and/or sparse matrices (see <a href="https://cran.r-project.org/web/packages/Matrix/index.html" class="external-link">Matrix</a>).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install latest development version from GitHub (requires <a href="https://github.com/hadley/devtools" class="external-link">devtools</a> package):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://devtools.r-lib.org/" class="external-link">"devtools"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"thomaswiemann/ddml"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-using-the-data-from-angrist--evans-1998">Example using the Data from Angrist &amp; Evans (1998)<a class="anchor" aria-label="anchor" href="#example-using-the-data-from-angrist--evans-1998"></a>
</h2>
<p>To illustrate <code>ddml</code> on a simple example, we can use the included random subsample of 5,000 observations from the data of Angrist &amp; Evans (1998). The data contains information on the labor supply of mothers, their children, as well as demographic data. See <code><a href="reference/AE98.html">?AE98</a></code> for details.</p>
<p>The goal of the exercise is to understand how an increase in the number of children causes a change in the employment status of mothers (<code>worked</code>). For this purpose, we consider the strategy of Angrist &amp; Evans (1998): To instrument for having more than two children (<code>morekids</code>), the authors use the <code>samesex</code> variable that indicates whether the first two children are either both male or female. The idea is that families with two same-sex children are more likely to have preferences for a third child (of the opposite sex). Additional controls, including the age and years of education of the mother, are included to address concerns about endogeneity of the instrument.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load ddml</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thomaswiemann/ddml" class="external-link">ddml</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct variables from the included Angrist &amp; Evans (1998) data</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">AE98</span><span class="op">[</span>, <span class="st">"worked"</span><span class="op">]</span></span>
<span><span class="va">D</span> <span class="op">=</span> <span class="va">AE98</span><span class="op">[</span>, <span class="st">"morekids"</span><span class="op">]</span></span>
<span><span class="va">Z</span> <span class="op">=</span> <span class="va">AE98</span><span class="op">[</span>, <span class="st">"samesex"</span><span class="op">]</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">AE98</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"agefst"</span>,<span class="st">"black"</span>,<span class="st">"hisp"</span>,<span class="st">"othrace"</span>,<span class="st">"educ"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>The causal model under consideration is the interactive model in which</p>
<p><img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Y%20%3D%20g_0%28D%2C%20X%29%20%2B%20U%2C%20%22Y%20=%20g_0(D,%20X)%20+%20U,%22" alt="Y = g_0(D, X) + U,"><br>
where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28Y%2C%20D%2C%20X%2C%20Z%2C%20U%29%20%22(Y,%20D,%20X,%20Z,%20U)%22" alt="(Y, D, X, Z, U)"> is a random vector with <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Y%20%22Y%22" alt="Y"> denoting the outcome, <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;D%20%22D%22" alt="D"> denoting the binary variable of interest, <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Z%20%22Z%22" alt="Z"> denoting the binary instrument, <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;X%20%22X%22" alt="X"> denoting the vector of controls, and <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;U%20%22U%22" alt="U"> denoting all other determinants of <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;Y%20%22Y%22" alt="Y"> other than <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28D%2C%20X%2C%20Z%29%20%22(D,%20X,%20Z)%22" alt="(D, X, Z)">. In this model, the local average treatment effect (LATE) is defined as<br><img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Ctheta_0%5E%7B%5Ctextrm%7BLATE%7D%7D%20%5Cequiv%20%20E%5Bg_0%281%2C%20X%29%20-%20g_0%280%2C%20X%29%5Cvert%20p_0%281%2C%20X%29%20%3E%20p%280%2C%20X%29%5D%2C%20%22%5Ctheta_0%5E%7B%5Ctextrm%7BLATE%7D%7D%20%5Cequiv%20E%5Bg_0(1,%20X)%20-%20g_0(0,%20X)%5Cvert%20p_0(1,%20X)%20%3E%20p(0,%20X)%5D,%22" alt="\theta_0^{\textrm{LATE}} \equiv E[g_0(1, X) - g_0(0, X)\vert p_0(1, X) &gt; p(0, X)],"><br>
where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;p_0%28Z%2C%20X%29%20%5Cequiv%20%5CPr%28D%3D1%5Cvert%20Z%2C%20X%29%20%22p_0(Z,%20X)%20%5Cequiv%20%5CPr(D=1%5Cvert%20Z,%20X)%22" alt="p_0(Z, X) \equiv \Pr(D=1\vert Z, X)"> denotes the propensity score.</p>
<p><code>ddml_late</code> estimates the LATE using double/debiased machine learning under the LATE assumptions of Imbens &amp; Angrist (1994). Double/debiased machine learning uses generic machine learners for the high dimensional nuisance parameters that arise in estimation of the LATE. <code>ddml</code> allows for combination of multiple machine learners using stacking to to increase robustness to the underlying data generating process.</p>
<p>Below, <code>ddml_late</code> estimates the LATE with shortstacking (a computationally convenient variant of stacking) based on three base learners: linear regression (<code>ols</code>), lasso (<code>mdl_glmnet</code>), and gradient boosting (<code>mdl_xgboost</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the local average treatment effect using short-stacking with base</span></span>
<span><span class="co">#     learners ols, rlasso, and xgboost.</span></span>
<span><span class="va">late_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ddml_late.html">ddml_late</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">D</span>, <span class="va">Z</span>, <span class="va">X</span>,</span>
<span>                      learners <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">ols</span><span class="op">)</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mdl_glmnet</span><span class="op">)</span>,</span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mdl_xgboost</span>,</span>
<span>                                         args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nrounds <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                                                     max_depth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      ensemble_type <span class="op">=</span> <span class="st">'nnls'</span>,</span>
<span>                      shortstack <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      sample_folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">late_fit</span><span class="op">$</span><span class="va">late</span></span>
<span><span class="co">#&gt;      nnls </span></span>
<span><span class="co">#&gt; -0.210019</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Ahrens A, Hansen C B, Schaffer M E, Wiemann T (2023). “ddml: Double/debiased machine learning in Stata.” <a href="https://arxiv.org/abs/2301.09397" class="external-link uri">https://arxiv.org/abs/2301.09397</a></p>
<p>Angrist J, Evans W, (1998). “Children and Their Parents’ Labor Supply: Evidence from Exogenous Variation in Family Size.” American Economic Review, 88(3), 450-477.</p>
<p>Chernozhukov V, Chetverikov D, Demirer M, Duflo E, Hansen C B, Newey W, Robins J (2018). “Double/debiased machine learning for treatment and structural parameters.” The Econometrics Journal, 21(1), C1-C68.</p>
<p>Wolpert D H (1992). “Stacked generalization.” Neural Networks, 5(2), 241-259.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/thomaswiemann/ddml/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/thomaswiemann/ddml/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ddml</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Achim Ahrens <br><small class="roles"> Author </small>  </li>
<li>Christian B Hansen <br><small class="roles"> Author </small>  </li>
<li>Mark E Schaffer <br><small class="roles"> Author </small>  </li>
<li>Thomas Wiemann <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/thomaswiemann/ddml/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/thomaswiemann/ddml/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/thomaswiemann/ddml" class="external-link"><img src="https://codecov.io/gh/thomaswiemann/ddml/branch/master/graph/badge.svg?token=PHB9W2TJ6S" alt="codecov"></a></li>
<li><a href="https://www.codefactor.io/repository/github/thomaswiemann/ddml" class="external-link"><img src="https://www.codefactor.io/repository/github/thomaswiemann/ddml/badge" alt="CodeFactor"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Achim Ahrens, Christian B Hansen, Mark E Schaffer, Thomas Wiemann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
